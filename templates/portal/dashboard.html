{% extends "student_base.html" %}
{% block title %}My Attendance{% endblock %}

{% block card %}
<div class="bg-white dark:bg-gray-800 rounded-2xl shadow-lg dark:shadow-gray-900/30 p-6 sm:p-8 max-w-lg w-full mx-auto">
    {% block content %}
    <!-- Header -->
    <div class="flex items-center justify-between mb-1">
        <h1 class="text-xl font-bold text-gray-900 dark:text-white">My Attendance</h1>
        <a href="{% url 'portal:portal_logout' %}"
           class="text-xs text-gray-400 hover:text-red-500 dark:hover:text-red-400 transition-colors">Logout</a>
    </div>
    <p class="text-sm text-gray-500 dark:text-gray-400 mb-5">
        {{ student.name }} ({{ student.student_id }})
    </p>

    {% if courses %}
    <p class="text-xs text-gray-400 dark:text-gray-500 mb-3">Minimum attendance required: {{ threshold }}%</p>

    <div class="space-y-3">
        {% for course in courses %}
        <a href="{% url 'portal:course_detail' course.id %}"
           class="block bg-gray-50 dark:bg-gray-700/50 rounded-xl p-4 hover:shadow-md hover:-translate-y-0.5 transition-all duration-200">
            <div class="font-semibold text-sm text-gray-900 dark:text-white mb-0.5">{{ course.name }}</div>
            <div class="text-xs text-gray-400 dark:text-gray-500 mb-2.5">{{ course.code }}</div>

            <!-- Progress bar -->
            <div class="h-2.5 bg-gray-200 dark:bg-gray-600 rounded-full overflow-hidden mb-1.5">
                <div class="h-full rounded-full transition-all duration-500
                            {% if course.percentage >= 70 %}bg-emerald-500{% elif course.percentage >= 50 %}bg-yellow-400{% else %}bg-red-500{% endif %}"
                     style="width: {{ course.percentage }}%"></div>
            </div>

            <div class="flex justify-between text-xs text-gray-500 dark:text-gray-400">
                <span>{{ course.attended }} / {{ course.total }} sessions</span>
                <span class="font-medium">{{ course.percentage }}%</span>
            </div>

            {% if course.below_threshold %}
            <p class="mt-1.5 text-xs font-semibold text-red-600 dark:text-red-400">Below {{ threshold }}% minimum attendance</p>
            {% endif %}
        </a>
        {% endfor %}
    </div>
    {% else %}
    <p class="text-center text-gray-400 dark:text-gray-500 py-8">No course enrollments found.</p>
    {% endif %}
    {% endblock %}
</div>
{% endblock %}
